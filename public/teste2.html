<!DOCTYPE html>
<html lang="pt-br" ng-app="catcons">
<head>
    <base href="/">
	<title></title>

<script src="http://testedev.provisorio.ws/wp-content/themes/tema-leo/js/angular.min.js"></script>

<script src="http://testedev.provisorio.ws/wp-content/themes/tema-leo/js/angular-route.min.js"></script>

<script src="http://testedev.provisorio.ws/wp-content/themes/tema-leo/js/ngMask.js"></script>


<script type="text/javascript">



	//aplicacao.js -------------------------------------------------------------------------------

	angular.module('catcons', ['minhasDiretivas','ngRoute', 'ngMask'])

    .config(function($routeProvider, $locationProvider) {







        //$locationProvider.html5Mode(true);



        /*

        $routeProvider.when('/helpers', {

            templateUrl: '/helpers/temp.html',

            controller: 'EstadosController',

        });

		*/



        //$routeProvider.otherwise({redirectTo: '/legal'});



    });



	//estados-controller.js -------------------------------------------------------------------------------

	angular.module("catcons").controller('EstadosController', function($scope, $http, $route, $location) {





	//console.log($route);

	//console.log($location.path());





		$scope.estados = [];



		$http.get("/helpers/estados.php")

		.success(function(estados) {



			$scope.estados = estados;

			console.log(estados);

		})

		.error(function(error) {

			console.log(erro);

		});









	});    



	//main-controller.js -------------------------------------------------------------------------------

	angular.module("catcons").controller('MainController', function($scope, $http, $route, $location) {





	//console.log($route);

	//console.log($location.path());

        $scope.contato = {};

		$scope.cidades_select = [];

        $scope.mensagem = {};

        $scope.erro = {};

        $scope.novo_registro = true;



		$scope.cidades = function() {



			$scope.contato.cidade = [];

			$scope.cidades_select = [];



			$http({

			        url: '/helpers/cidades.php',

			        method: "POST",

			        data: { estadouf : $scope.contato.estado },

				    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },

			    })

			    .then(function(response) {



					$scope.cidades_select = response.data;

					$scope.contato.cidade = "";



			    }, 

			    function(response) { // optional

			            console.log(response);

			    });





		};





        $scope.submeter = function() {



	        $scope.novo_registro = true;



        	if ($scope.formulario.$valid) {

	        	

	        	$http.post("/helpers/cadastrar.php", $scope.contato)

	        	.success(function(response) {

	        		

	        		if (response.error == 0) {

			

			        	$scope.mensagem = "Sua mensagem foi enviada com sucesso!";

			        	$scope.erro = "";

			        	$scope.contato = {};

				        $scope.novo_registro = false;



	        		}else{



			        	$scope.mensagem = "";

			        	$scope.erro = "Não foi possível enviar a mensagem. por favor entre em contato com o administrador do site.";



	        		}



	        	})

	        	.error(function(erro) {

	        		$scope.erro = "Não foi possível enviar a mensagem";

	        	});



        	}



        };





	});





	//diretivas.js -------------------------------------------------------------------------------

	angular.module("minhasDiretivas", [])

	.directive("meuPainel", function() {



		//meu painel no html fiuca com hifen <meu-painel>



		var ddo = {};



		ddo.restric = "AE";

		//pode ser usado com atributo e elemento



		ddo.scope = {

			estado: '@'

		};

		// O @ indica q o calor será passado como string para dentro do escopo privado da diretiva



		ddo.transclude = true;

		// O transclude faz com que os elementos filhos da diretiva caso ela possua sejam mantidos



		ddo.templateUrl = "/helpers/diretiva-minha-foto.html";



	/*

	    ddo.template = 

	        '<div class="panel panel-default">'

	    +   '   <div class="panel-heading">'

	    +   '        <h3 class="panel-title text-center">{{titulo}}</h3> '

	    +   '   </div>'

	    +   '   <div class="panel-body" ng-transclude >'

	    +   '   </div>'

	    +   '</div>'

	*/



		return ddo;



	});







</script>


</head>
<body>

</body>
</html>